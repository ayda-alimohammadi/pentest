from django.shortcuts import render
from .models import Note
from rest_framework import viewsets
from .serializers import NoteSerializer
from rest_framework.decorators import api_view
from rest_framework.response import Response
import requests
import logging

logger = logging.getLogger(__name__)

class NotesViewset(viewsets.ModelViewSet):
    serializer_class = NoteSerializer
    queryset = Note.objects.all()

@api_view(['GET'])
def dvwa_request(request):
    url = 'http://localhost/DVWA/vulnerabilities/xss_d/'
    logger.info(f"Requesting DVWA URL: {url} with params: {request.GET}")
    response = requests.get(url, params=request.GET)
    logger.info(f"Response from DVWA: {response.text}")
    print("OK")
    return Response({'data': response.text})
